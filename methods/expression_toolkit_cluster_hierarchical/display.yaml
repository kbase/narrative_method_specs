#
# Define basic display information
#
name     : Cluster Expression Data - Hierarchical

tooltip  : |
    Perform hierarchical clustering to group gene expression data into a dendrogram.

screenshots :
    []

icon: kb_expr-yellow.png

#
# Define the set of other narrative methods that should be suggested to the user.
#
method-suggestions :
    related :
        []
    next :
        []


#
# Configure the display and description of the parameters
#
parameters :
    input_expression_matrix:
        ui-name : |
            Expression Matrix
        short-hint : |
            Select the Expression Matrix to use for hierarchical clustering
        long-hint  : |
            Choose an Expression Matrix from your Data Panel to use with this method. You can upload an Expression Matrix into your Narrative by clicking the <i>Add Data</i> button and selecting the <i>Import</i> tab.

    feature_height_cutoff:
        ui-name : |
            Tree height cutoff
        short-hint : |
            Metric for cutting the branches of the tree (percentage of tree height)
        long-hint  : |
            The tree height cutoff parameter affects the branching of clusters in the dendrogram. Subgroups that join at a distance below this value are put in the same cluster. 

    output_cluster_set :
        ui-name : |
            Set of clusters
        short-hint : |
            Provide name for set of clusters generated by algorithm
        long-hint  : |
            After the method has finished running, a ClusterSet data object will be added to your data panel. Provide a name for this data object, using only alphanumeric characters and underscores.

    max_items :
        ui-name : Max. number of rows
        short-hint : Maximum number of rows (recommended only for large datasets)
        long-hint  : Maximum number of rows (recommended only for large datasets)

    algorithm :
        ui-name : Algorithm
        short-hint : Select between a normal clustering algorithm (hclust) and a fast version (flashClust)
        long-hint  : Select between a normal clustering algorithm (hclust) and a fast version (flashClust)


description : |
    <p>This method organizes gene expression data into a dendrogram (cluster tree) by using distance and linkage criteria to analyze dissimilarity between observations in the data and sorting these observations into the branches of the tree. Agglomerative clustering is used to build a hierarchy of clusters by progressively merging individual clusters into groups. This is useful for understanding the similarities and dissimilarities between sets of data based on their grouping patterns throughout the cluster tree.</p>

    <p>Begin by selecting or importing both the expression dataset to analyze and the genome associated with the expression dataset using the Add Data button. Provide a name for the output set of clusters. Define the height to cut the branches of the tree, set the parameters for computing the dissimilarity between sets, and select the hierarchical clustering algorithm to use for the analysis.</p>
    
    <p>The input is a .tsv file with "gene-id" listed in the A1 cell, the gene ids listed in the A column, the sample/conditions identifiers in the 1 row, and expression values that correspond to the gene-ids and sample throughout. For a comprehensive guide to formatting your expression data for import into KBase, see the <a href="http://kbase.us/data-upload-download-guide/expression-matrix/">Data Upload/Download Guide</a>.</p>    

    <p>Description of hierarchical clustering algorithms: 
        <ul>
        <li>hclust (default): Performs a hierarchical cluster analysis using a set of dissimilarities for the number of objects being clustered (<a href="http://www.inside-r.org/packages/cran/amap/docs/hcluster">technical documentation for hclust</a>)</li>
        <li>flashClust: Faster version of the hclust algorithm (<a href="https://cran.r-project.org/web/packages/flashClust/flashClust.pdf">technical documentation for flashClust</a>)</li>
    </ul></p>

    <p><strong>Team members who developed & deployed algorithm in KBase:</strong>
    Paramvir Dehal, Roman Sutormin, Michael Sneddon, Srividya Ramakrishnan, Pavel Novichkov, Keith Keller.</p>
    
    <p>For questions, <a href="mailto:help@kbase.us">e-mail help@kbase.us</a></p>
